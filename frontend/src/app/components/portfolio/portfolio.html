<h1>üìä Portfolio</h1>

<!-- MongoDB Connection Status -->
<div class="mb-4 p-3 rounded-lg" [ngClass]="(portfolio$ | async)?.source === 'professional' ? 'bg-green-100 border border-green-300' : 'bg-yellow-100 border border-yellow-300'">
  <div class="flex items-center gap-2">
    <span *ngIf="(portfolio$ | async)?.source === 'professional'" class="text-green-600">‚úÖ MongoDB Connected</span>
    <span *ngIf="(portfolio$ | async)?.source !== 'professional'" class="text-yellow-600">‚ö†Ô∏è Demo Mode</span>
    <span class="text-sm text-gray-600">Data saved to database automatically</span>
  </div>
</div>

<div class="portfolio-grid">
  <div class="portfolio-summary">
    <h2>Account Summary</h2>
    <p>Cash: ${{ (portfolio$ | async)?.cash || '0.00' }}</p>
    <p>Portfolio Value: ${{ (portfolio$ | async)?.portfolio_value || '0.00' }}</p>
    <p>Positions: {{ (portfolio$ | async)?.positions?.length || '0.00' }}</p>
    <p>Day P&L: ${{ (portfolio$ | async)?.day_gain || '0.00' }}</p>
  </div>

  <div class="positions">
    <h2>Positions ({{ (portfolio$ | async)?.positions?.length || 0}}</h2>
    <div *ngFor="let position of (portfolio$ | async)?.positions" class="position-item">
      <span>{{ position.symbol }}: {{ position.qty }} shares</span>
      <span>${{ position.market_value || '0.00' }}</span>
    </div>
  </div>

  <div class="trade-panel">
    <h2>Quick Trade</h2>
    <input #symbolInput type="text" placeholder="Symbol" value="SPY">
    <input #qtyInput type="number" placeholder="Quantity" value="10">
    <button (click)="placeTrade(symbolInput.value, 'buy', +qtyInput.value)">Buy</button>
    <button (click)="placeTrade(symbolInput.value, 'sell', +qtyInput.value)">Sell</button>
    <button (click)="refreshPortfolio()" [disabled]="isLoading">
      üîÑ {{ isLoading ? 'Loading...' : 'Refresh Portfolio' }}
    </button>
  </div>
</div>


